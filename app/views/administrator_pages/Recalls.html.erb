<% provide(:title, "Product Recalls") %>

<!--<div class="center hero-unit">
  <h1 style="font-size:35px;">Product Recalls</h1>
  <h2>
		Recalls
  </h2>
</div>-->

<% if current_user.admin? %>
	<a href="#CreateRecall" role="button" class="btn" data-toggle="modal">Create New Recall</a>
	<br/>
	<br/>
<% end %>

<div id="CreateRecall" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
		<h3 id="myModalLabel">Modal header</h3>
	</div>
	<%= form_for :recall, :url => {:action => :create}  do |f| %>
	
		<div class="modal-body">
			

				<%= f.label :Category, "Category" %>

			<div class="control-group">
				<div class="controls">	
					<%= f.select :Category,options_for_select(["Consumer Products",
						"Foods, Medicines, Cosmetics",
						"Meat and Poultry Products",
						"Motor Vehicles",
						"Child Safety Seats",
						"Tires",
						"Vehicle Emissions",
						"Environmental Products",
						"Boats and Boating Safety"]), {:style => "height:40px"} %>
				</div>
			</div>

			<%= f.label :Products, "Product" %>
			<div class="control-group">
				<div class="controls">
					<%= f.select :Products, options_for_select(["All Terrain Vehicles (ATV)",
						"Saws",
						"Gasoline",
						"Door Sills or Frames",
						"Fuels and Gas and Oils",
						"Sports and Recreation",
						"Toys",
						"Fans",
						"Lawn Mowers",
						"Grass And Leaf Catchers",
						"Home Appliances, Maintenance",
						"Babies and Kids",
						"Other Grills",
						"Swings or Swing Sets",
						"Electrical Systems",
						"Portable Generators",
						"Yard and Garden",
						"Recreational Vehicles",
						"Other Bags",
						"Gardening and Landscaping"]), { :style => "height:40px"} %>
				</div>
			</div>
			<div class="form-inline">
				<%= f.label :Manufacturer,"Manufacturer" %>
			</div>
			<%= f.text_field :Manufacturer %>

			<div class="form-inline">
				<%= f.label :Title, "Title" %>
			</div>
			<%= f.text_field :Title %>

			<div class="form-inline">
				<%= f.label :Summary, "Summary" %>
			</div>
			<%= f.text_field :Summary %>

			<div class="form-inline">
				<%= f.label :Details, "Details" %>
			</div>
			<%= f.text_field :Details %>

			<%= f.label :Hazards, "Hazard" %>
			<div class="control-group">
				<div class="controls">
					<%= f.select :Hazards, options_for_select(["Injury",
						"Fire",
						"Collision",
						"Cuts",
						"Physical",
						"Crash",
						"Heat-Related",
						"Burn",
						"Electrical",
						"Explosion",
						"Heat-Related Explosion",
						"Falling",
						"Collapse",
						"Impact",
						"Entanglement",
						"Ejection",
						"Strangulation",
						"Bruising"]), { :style => "height:40px"} %>
				</div>
			</div>

		</div>

		<br/>
		<br/>
		<div class="modal-footer">
			<button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
			<%= f.submit "Create Recall", class: "btn btn-large btn-primary" %>
		</div>
   	<% end %>
</div>





<div class="tabbable tabs-left">
	
	<ul class="nav nav-tabs">
		<% @categories.each_with_index do |c,i| %>
			<% if i == 0 %>
				<li class="active">
					<a data-toggle="tab" href="#<%= i %>">
						<%= c.Category %>
					</a>
				</li>
			<% else %>
				<li>
					<a data-toggle="tab" href="#<%= i %>">
						<%= c.Category %>
					</a>
				</li>
			<% end %>
		<% end %>
	</ul>
	
	<div class="tab-content">
		<% @categories.each_with_index do |c,i| %>
			<% if i == 0 %>
				<div id="<%= i %>" class="tab-pane active">
					<% Recall.where("\"Category\" = ?", c.Category).each_with_index do |r,j| %>
						<p>

							<a href="#<%= "#{i.to_s+j.to_s}" %>" role="button"  data-toggle="modal"><%= r.Title.html_safe %></a>
								<% if current_user.admin? %>
							 		| <%= link_to 'Edit', :action => :edit, :id => r.id %>
                                   	| <%= link_to "Delete", :id => r.id,:action => 'destroy', method: :delete, 
                                   	confirm: "You sure?"  %>
                                <% end %>
						</p>

					<% end %>
				</div>
			<% else %>
				<div id="<%= i %>" class="tab-pane">
					<% Recall.where("\"Category\" = ?", c.Category).each_with_index do |r,j| %>
						<p>

							<a href="#<%= "#{i.to_s+j.to_s}" %>" role="button"  data-toggle="modal"><%= r.Title.html_safe %></a>
								<% if current_user.admin? %>
							 		| <%= link_to 'Edit', :action => :edit, :id => r.id %>
                                   	| <%= link_to "Delete", :id => r.id,:action => 'destroy', method: :delete, 
                                   	confirm: "You sure?"  %>
                                <% end %>
						</p>

					<% end %>
				</div>
			<% end %>
		<% end %>
	</div>
</div>

<% @categories.each_with_index do |c,i| %>
	<% Recall.where("\"Category\" = ?", c.Category).each_with_index do |r,j| %>
		<div id="<%= "#{i.to_s+j.to_s}" %>" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
				<h4 id="myModalLabel"><%= r.Title.html_safe %></h4>
			</div>
			<div class="modal-body">
				<p>
					<b>Manufacturer</b>
				</p>
				<p>
					<%= r.Manufacturer.to_s.html_safe %>
				</p>
				<p>
					<b>Product</b>
				</p>
				<p>
					<%= r.Products.to_s.html_safe %>
				</p>
				<p>
					<b>Summary</b>
				</p>
				<p>
					<%= r.Summary.to_s.html_safe %>
				</p>
				<p>
					<b>Description</b>
				</p>
				<p>
					<%= r.Details.to_s.html_safe %>
				</p>
				<p>
					<b>Hazard</b>
				</p>
				<p>
					<%= r.Hazards.to_s.html_safe %>
				</p>
				<p>
					<b>Date Created</b>
				</p>
				<p>
					<%= r.created_at.to_date %>
				</p>
				<hr>
			</div>
			<div class="modal-footer">
				<button class="btn btn-primary" data-dismiss="modal" aria-hidden="true">Close</button>
			</div>
		</div>
	<% end %>
<% end %>